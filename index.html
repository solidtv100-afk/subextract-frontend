<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>YouTube Subtitle Downloader – TXT</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="description" content="Download English YouTube subtitles as TXT. Free, fast, mobile-friendly.">
<meta name="robots" content="index, follow">

<style>
:root {
  --bg: #020617;
  --card: #0f172a;
  --text: #e5e7eb;
  --muted: #94a3b8;
  --accent: #22c55e;
  --danger: #ef4444;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: linear-gradient(180deg, #020617, #020617);
  color: var(--text);
}

.container {
  max-width: 420px;
  margin: auto;
  padding: 24px;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.card {
  background: var(--card);
  border-radius: 18px;
  padding: 24px;
  box-shadow: 0 20px 40px rgba(0,0,0,.45);
}

h1 {
  font-size: 22px;
  text-align: center;
  margin: 0 0 6px;
}

.subtitle {
  text-align: center;
  font-size: 13px;
  color: var(--muted);
}

input {
  width: 100%;
  padding: 14px 16px;
  margin-top: 18px;
  border-radius: 12px;
  border: 1px solid #1e293b;
  background: #020617;
  color: var(--text);
  font-size: 15px;
  outline: none;
}

input:focus {
  border-color: var(--accent);
}

button {
  width: 100%;
  margin-top: 14px;
  padding: 14px;
  border-radius: 12px;
  border: none;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
  background: var(--accent);
  color: #022c22;
}

button:disabled {
  background: #334155;
  color: #cbd5f5;
  cursor: not-allowed;
}

.status {
  margin-top: 14px;
  text-align: center;
  font-size: 14px;
  min-height: 20px;
}

footer {
  text-align: center;
  font-size: 12px;
  color: var(--muted);
  margin-top: 18px;
}
</style>
</head>

<body>
<div class="container">
  <div class="card">
    <h1>YouTube Subtitle Downloader</h1>
    <div class="subtitle">
      English → TXT • Public captions only
    </div>

    <input id="url" type="url" placeholder="Paste YouTube link">

    <button id="btn">Download TXT</button>
    <div class="status" id="status"></div>

    <footer>
      No login • No video download • Free
    </footer>
  </div>
</div>

<script>
/* ================= CONFIG ================= */
const BACKEND_URL = "https://YOUR-RENDER-APP.onrender.com/extract";

/* ===== SIMPLE CLIENT-SIDE RATE LIMIT ===== */
const LIMIT = 5;            // requests
const WINDOW = 10 * 60e3;   // 10 minutes

function allowed() {
  const now = Date.now();
  let data = JSON.parse(localStorage.getItem("rate") || "[]");
  data = data.filter(t => now - t < WINDOW);
  if (data.length >= LIMIT) return false;
  data.push(now);
  localStorage.setItem("rate", JSON.stringify(data));
  return true;
}

/* ================= LOGIC ================= */
const btn = document.getElementById("btn");
const status = document.getElementById("status");

btn.onclick = async () => {
  const url = document.getElementById("url").value.trim();
  if (!url) {
    status.textContent = "⚠️ Paste a YouTube link";
    return;
  }

  if (!allowed()) {
    status.textContent = "⛔ Too many requests. Try later.";
    return;
  }

  btn.disabled = true;
  status.textContent = "⏳ Fetching subtitles…";

  try {
    const res = await fetch(
      `${BACKEND_URL}?url=${encodeURIComponent(url)}`
    );

    if (!res.ok) throw new Error();

    const text = await res.text();
    const blob = new Blob([text], { type: "text/plain" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "subtitles.txt";
    a.click();

    status.textContent = "✅ Download started";
  } catch {
    status.textContent = "❌ English subtitles not available";
  } finally {
    btn.disabled = false;
  }
};
</script>
</body>
</html>
